# SSPanel 对接 ssr 混淆、协议单端口

> 该教程是 ssr 单端口多用户教程，ssr 多端口多用户请参看：[跳转](ssr/sspanel-ssr-multi-port.md)
>
> 由于 sspanel 面板设计原因，配置单端口较为复杂，请耐心按照教程操作，初次配置可能会遇到问题
>
> sspanel 设计的单端口有两种，分别为：**混淆式单端口**、**协议式单端口**。

> 支持混淆式单端口与协议式单端口并存（不同端口），添加两个承载节点和对应的承载用户即可。

# 混淆式单端口

支持以下配置

| 混淆                 | 搭配协议   | 搭配加密          | 备注         |
|--------------------|--------|---------------|------------|
| simple_obfs_http   | origin | 任意，推荐 AEAD 加密 | 使用 ss 客户端  |
| simple_obfs_tls    | origin | 任意，推荐 AEAD 加密 | 使用 ss 客户端  |
| http_simple        | 任意     | 非 AEAD 加密     | 使用 ssr 客户端 |
| http_post          | 任意     | 非 AEAD 加密     | 使用 ssr 客户端 |
| tls1.2_ticket_auth | 任意     | 非 AEAD 加密     | 使用 ssr 客户端 |

混淆式单端口特殊配置：

| 参数名           | 默认值              | 说明                            |
|---------------|------------------|-------------------------------|
| `mu_suffix`   | `microsoft.com`  | 需和面板配置相同，默认无需修改               |
| `mu_regex`    | `%5m%id.%suffix` | 需和面板配置相同，默认无需修改               |
| `ss_obfs_udp` | `false`          | 是否开启混淆单端口 udp，注意无法统计用户 udp 流量 |

# 协议式单端口

支持以下配置，均使用 ssr 客户端连接

| 协议               | 搭配加密      | 搭配混淆    |
|------------------|-----------|---------|
| auth_aes128_md5  | 非 AEAD 加密 | 非 ss 混淆 |
| auth_aes128_sha1 | 非 AEAD 加密 | 非 ss 混淆 |
| auth_chain_a     | 非 AEAD 加密 | 非 ss 混淆 |
| auth_chain_b     | 非 AEAD 加密 | 非 ss 混淆 |
| auth_chain_c     | 非 AEAD 加密 | 非 ss 混淆 |
| auth_chain_d     | 非 AEAD 加密 | 非 ss 混淆 |
| auth_chain_e     | 非 AEAD 加密 | 非 ss 混淆 |
| auth_chain_f     | 非 AEAD 加密 | 非 ss 混淆 |

协议式单端口特殊配置：

| 参数名             | 默认值    | 说明                          |
|-----------------|--------|-----------------------------|
| `ssr_cid_limit` | `true` | 是否开启设备数限制的功能，若关闭，则使用 IP 数限制 |

# 第一步，添加一个单端口承载节点

> 该节点不是一个真实节点，仅仅是给单端口做配置的

在面板中添加一个承载节点，记住你所填写的端口号

# 第二步，添加一个单端口承载用户

> 该用户不是一个真实用户，仅仅是给单端口做配置的

在面板中添加一个承载用户，配置对应的加密方式、协议和混淆

# 第三步，添加一个正常的 Shadowsocks 节点

## 节点地址格式

```
连接IP或域名;port=必填承载节点配置的端口#用户连接端口
```

示例

> 该示例中，heki 监听 12345 端口，用户连接 23456 端口

```
hk.aaa.com;port=12345#23456
```

# 第四步，配置 heki

参考: [heki 详细配置项](heki/heki-config.md)

# 第五步，启动 heki

```
heki start
```

若出现启动失败的情况，使用`heki log`查看错误信息
